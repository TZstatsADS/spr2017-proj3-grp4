---
title: "R Notebook"
output: html_notebook
---

#read data
```{r}
sift.features=read.csv("../data/sift_features.csv", header = T)
label=read.csv("../data/labels.csv")
```

#train n test
```{r}
index=sample(1:2000,400,replace = F)
all=data.frame(cbind(label,t(sift.features)))
colnames(all)[1]="y"
test=all[index,]
train=all[-index,]
```

#baseline
```{r}
library(gbm)
library(caret)
gbm1=gbm(y~.,data=train,dist="adaboost",n.tree = 400,shrinkage = 0.1)
n=gbm.perf(gbm1)

confusionMatrix( predict(gbm1,train,n.trees=n)>0,train$y >0)$table
confusionMatrix( predict(gbm1,test,n.trees = n)>0,test$y >0)$table

```

#tree depth=6
```{r}
gbm2=gbm(y~.,data=train,dist="adaboost",n.tree = 100,shrinkage = 0.1,interaction.depth = 6)
m=gbm.perf(gbm2)
confusionMatrix( predict(gbm2,train,n.trees =m)>0,train$y >0)$table
confusionMatrix( predict(gbm2,test,n.trees =m)>0,test$y >0)$table

```